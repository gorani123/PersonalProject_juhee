<template>
  <div>
    <!-- ÏÉÅÎã®Î∞î ÏñëÏãù -->
    <div
      class="hero page-inner overlay"
      style="background-image: url('images/hero_bg_3.jpg')"
    >
      <div class="container">
        <div class="row justify-content-center align-items-center">
          <div class="col-lg-9 text-center mt-5">
            <h1 class="heading" data-aos="fade-up">Sell Property</h1>

            <nav
              aria-label="breadcrumb"
              data-aos="fade-up"
              data-aos-delay="200"
            >
              <ol class="breadcrumb text-center justify-content-center">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li
                  class="breadcrumb-item active text-white-50"
                  aria-current="page"
                >
                  Upload property
                </li>
              </ol>
            </nav>
          </div>
        </div>
      </div>
    </div>
    <!-- ÏÉÅÎã®Î∞îÏñëÏãù ÎÅù -->

    <div class="section">
      <div class="container">
        <div class="row">
          <div
            class="col-lg-4 mb-5 mb-lg-0"
            data-aos="fade-up"
            data-aos-delay="100"
          >
            <div class="contact-info">
              <div class="address mt-2">
                <i class="icon-room"></i>
                <h4 class="mb-2">Location:</h4>
                <p>
                  43 Raymouth Rd. Baltemoer,<br />
                  London 3910
                </p>
              </div>

              <div class="open-hours mt-4">
                <i class="icon-clock-o"></i>
                <h4 class="mb-2">Open Hours:</h4>
                <p>
                  Sunday-Friday:<br />
                  11:00 AM - 2300 PM
                </p>
              </div>

              <div class="email mt-4">
                <i class="icon-envelope"></i>
                <h4 class="mb-2">Email:</h4>
                <p>info@Untree.co</p>
              </div>

              <div class="phone mt-4">
                <i class="icon-phone"></i>
                <h4 class="mb-2">Call:</h4>
                <p>+1 1234 55488 55</p>
              </div>
            </div>
          </div>


          <!-- Îß§Î¨º ÏóÖÎ°úÎìú Ìèº ÏñëÏãù -->
          <div class="col-lg-8" data-aos="fade-up" data-aos-delay="200">
            <form action="#">
              <div class="row">
                <div class="col-6 mb-3">
                  <label for="propertyTitle" class="form-label"
                    >Property Title</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="propertyTitle"
                    required
                    name="propertyTitle"
                    placeholder="ex) Ìï¥Ïö¥ÎåÄ ÏïÑÏù¥ÌååÌÅ¨"
                    v-model="propertyTitle"
                  />
                </div>
                <div class="col-6 mb-3">
                  <label for="propertyPrice" class="form-label">Price</label>
                  <input
                    type="text"
                    class="form-control"
                    id="propertyPrice"
                    required
                    name="propertyPrice"
                    placeholder="ex) 13Ïñµ 5000"
                    v-model="propertyPrice"
                  />
                </div>
                <div class="col-12 mb-3">
                  <label for="propertyAddress" class="form-label"
                    >Address</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="propertyAddress"
                    required
                    name="propertyAddress"
                    placeholder="ex) Ìï¥Ïö¥ÎåÄÍµ¨ ÎßàÎ¶∞ÏãúÌã∞2Î°ú 38"
                    v-model="propertyAddress"
                  />
                </div>
                <div class="col-12 mb-3">
                  <label for="propertyCity" class="form-label">City</label>
                  <input
                    type="text"
                    class="form-control"
                    id="propertyCity"
                    required
                    name="propertyCity"
                    placeholder="ex) Î∂ÄÏÇ∞Í¥ëÏó≠Ïãú"
                    v-model="propertyCity"
                  />
                </div>
                <div class="col-12 mb-3">
                  <label for="propertyBed" class="form-label">Bed</label>
                  <input
                    type="number"
                    class="form-control"
                    id="propertyBed"
                    required
                    name="propertyBed"
                    placeholder="ex) 3 "
                    v-model="propertyBed"
                  />
                </div>
                <div class="col-12 mb-3">
                  <div class="mb-4 col-md-3">
                    <label for="propertyBath" class="form-label">Bath</label>
                    <input
                      type="number"
                      class="form-control"
                      id="propertyBath"
                      required
                      name="propertyBath"
                      placeholder="ex) 1"
                      v-model="propertyBath"
                    />
                  </div>

                  <!-- Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉùÏÉÅÏûê ÏãúÏûë -->
                  <div class="mb-3 col-md-5">
                    <label class="btn btn-default p-0">
                      <!-- <!‚Äî ÌååÏùº ÏÑ†ÌÉùÏÉÅÏûê ‚Äî> -->
                      <input
                        type="file"
                        accept="image/*"
                        ref="file"
                        @change="selectProperty"
                      />
                    </label>
                  </div>
                  <!-- Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉùÏÉÅÏûê ÎÅù -->

                  <button
                    class="btn btn-success btn-sm float-left"
                    :disabled="!currentProperty"
                    @click="upload"
                  >
                    Upload
                  </button>
                  <router-link
                    to="/buy"
                    class="btn btn-success btn-sm float-left"
                    >Îì±Î°ùÌôïÏù∏</router-link
                  >

                  <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ Ïù¥ÎØ∏ÏßÄ ÏãúÏûë -->
                  <div v-if="previewProperty" class="preview">
                    <div>
                      <img
                        width="200"
                        class="preview my-3"
                        :src="previewProperty"
                        alt=""
                      />
                    </div>
                  </div>
                  <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ Ïù¥ÎØ∏ÏßÄ ÎÅù -->

                  <!-- ÏÑúÎ≤Ñ ÏóêÎü¨ Î©îÏÑ∏ÏßÄÍ∞Ä ÏûàÏùÑ Í≤ΩÏö∞ ÏïÑÎûò Ï∂úÎ†• ÏãúÏûë -->
                  <div
                    v-if="message"
                    class="alert alert-secondary"
                    role="alert"
                  >
                    {{ message }}
                  </div>
                  <!-- ÏÑúÎ≤Ñ ÏóêÎü¨ Î©îÏÑ∏ÏßÄÍ∞Ä ÏûàÏùÑ Í≤ΩÏö∞ ÏïÑÎûò Ï∂úÎ†• ÎÅù -->
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
// axios Í≥µÌÜµ Ìï®Ïàò import
import PropertyDataService from "../../service/PropertyDataService";

import navbarCom from "../../assets/js/navbar";
import counterCom from "../../assets/js/counter";
import customCom from "../../assets/js/custom";

export default {
  data() {
    return {
      currentProperty: undefined, // ÌòÑÏû¨ Ïù¥ÎØ∏ÏßÄ Î≥ÄÏàò
      previewProperty: undefined, // ÎØ∏Î¶¨Î≥¥Í∏∞ Ïù¥ÎØ∏ÏßÄ Î≥ÄÏàò
      message: "", // ÏÑúÎ≤ÑÏ™ΩÏóêÏÑú ÏóêÎü¨Í∞Ä ÎÇ† Îïå Î≥¥ÎÇ¥Îäî Î©îÏãúÏßÄÎ•º Ï†ÄÏû•Ìï† Î≥ÄÏàò
      property: [], // Ïù¥ÎØ∏ÏßÄ Í∞ùÏ≤¥ Î∞∞Ïó¥(Ïó¨Îü¨ Í∞ú)Ïù¥ ÎÇ†ÏïÑÏò§Î©¥ Ï†ÄÏû•ÎêòÎäî Í≥≥üëÄ
      searchSelect: "", // Ïù¥Î¶ÑÏúºÎ°ú Í≤ÄÏÉâÌïòÎäî Î≥ÄÏàò

      // springboot ÏöîÏ≤≠Ìï† Î≥ÄÏàò , Ïù¥ÎØ∏ÏßÄÎ™Ö(propertyTitle), ÎÇ¥Ïö©(content)
      propertyTitle: "",
      propertyPrice: "",
      propertyAddress: "",
      propertyCity: "",
      propertyBed: "",
      propertyBath: "",

      // ÌéòÏù¥ÏßïÏùÑ ÏúÑÌïú Î≥ÄÏàò Ï†ïÏùò
      page: 1, // ÌòÑÏû¨ ÌéòÏù¥ÏßÄ
      count: 0, // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Í±¥Ïàò
      pageSize: 3, // ÌïúÌéòÏù¥ÏßÄÎãπ Î™áÍ∞úÎ•º ÌôîÎ©¥Ïóê Î≥¥Ïó¨Ï§ÑÏßÄ Í≤∞Ï†ïÌïòÎäî Î≥ÄÏàò

      pageSizes: [3, 6, 9], // select box Ïóê ÎÑ£ÏùÑ Í∏∞Î≥∏ Îç∞Ïù¥ÌÑ∞
    };
  },
  methods: {
    // Ï°∞Ìöå Ìï®Ïàò
    retrieveProperty() {
      PropertyDataService.getPropertys(
        this.propertyTitle,
        this.page - 1,
        this.pageSize
      ) // ÌîÑÏóî ÏûêÎèô ÌéòÏù¥ÏßïÏ≤òÎ¶¨Í∞Ä 1Î∂ÄÌÑ∞ ÏãúÏûëÌïòÎØÄÎ°ú -1Ìï¥ÏÑú 0ÏúºÎ°ú ÎßåÎì§Ïñ¥ Ï§å(Ïä§ÌîÑÎßÅÎ∂ÄÌä∏Îäî 0Î≤àÎ∂ÄÌÑ∞ Îß§Í∏∞ÎãàÍπå ÎßûÏ∂∞Ï§å)
        //  axiosÏÑ±Í≥µÌïòÎ©¥ Ïä§ÌîÑÎßÅÎ∂ÄÌä∏ Í≤∞Í≥ºÍ∞Ä .then() ÏïàÏúºÎ°ú Ï†ÑÏÜ°Îê®
        .then((response) => {
          // const(let){ÏÜçÏÑ±Î™Ö, ÏÜçÏÑ±Î™Ö2} = Îç∞Ïù¥ÌÑ∞Í∞ùÏ≤¥Î∞∞Ïó¥  : Î™®ÎçòÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏ Î¨∏Î≤ï Íµ¨Ï°∞Î∂ÑÌï¥Ìï†Îãπ
          const { property, totalItems } = response.data; //  springboot ÏóêÏÑú Ï†ÑÏÜ°Îêú Îßµ(map) Ï†ïÎ≥¥
          this.property = property; // Ïä§ÌîÑÎßÅÎ∂ÄÌä∏ÏóêÏÑú Ï†ÑÏÜ°Ìïú Îç∞Ïù¥ÌÑ∞
          this.count = totalItems; // Ïä§ÌîÑÎßÅÎ∂ÄÌä∏ÏóêÏÑú Ï†ÑÏÜ°Ìïú ÌéòÏù¥ÏßÄÏ†ïÎ≥¥(Ï¥ù Í±¥Ïàò)
          // ÎîîÎ≤ÑÍπÖ ÏΩòÏÜîÏóê Ï†ïÎ≥¥ Ï∂úÎ†•
          console.log(response.data);
        })
        // Ïã§Ìå®ÌïòÎ©¥ .catch() Ïóê ÏóêÎü¨Í∞Ä Ï†ÑÏÜ°Îê®
        .catch((e) => {
          console.log(e);
        });
    },
    // ÌååÏùº ÏÑ†ÌÉùÏÉÅÏûêÏóêÏÑú ÏÑ†ÌÉùÌïú Ïù¥ÎØ∏ÏßÄÎ•º Ï†ÄÏû•ÌïòÎäî Ìï®Ïàò
    selectProperty() {
      // Ï≤´Î≤àÏß∏ ÏÑ†ÌÉùÌïú Ïù¥ÎØ∏ÏßÄÎ•º Î≥ÄÏàòÏóê Ï†ÄÏû•
      //  this.$refs : htmlÏóêÏÑú $refs ÏÜçÏÑ±Ïù¥ ÏûàÎäî Ïª®Ìä∏Î°§Ïù¥ ÏÑ†ÌÉùÎê®(Î∞îÎ°úÏ†ëÍ∑ºÍ∞ÄÎä•)_Ïù¥ÎØ∏ÏßÄ ÏÑ†ÌÉùÏÉÅÏûêÏùò inputÎ∞ïÏä§Ïóê ref Í±∏Î†§ÏûàÏùå(ref="property")
      //               refs.property Ï§ëÏóê Ïù¥Î¶ÑÏù¥ PropertysÏù∏ Ïï† ÏÑ†ÌÉù
      this.currentProperty = this.$refs.file.files.item(0); // Î∞∞Ïó¥ Ï§ë Ï≤´Î≤àÏß∏ ÏÑ†ÌÉùÌïú Ïù¥ÎØ∏ÏßÄ(0)Î•º ÌòÑÏû¨ Ïù¥ÎØ∏ÏßÄ Î≥ÄÏàò
      // .createObjectURL() : Ïù¥ÎØ∏ÏßÄ Ï£ºÏÜåÎßå Ï∞∏Ï°∞Ìï¥ÏÑú Ïù¥ÎØ∏ÏßÄ Î≥¥Ïó¨Ï£ºÍ∏∞ Ìï®Ïàò
      this.previewProperty = URL.createObjectURL(this.currentProperty);
      this.message = "";
    },
    //  upload Ìï®Ïàò : Î≥ÄÏàò 7Í∞úÏùò Îç∞Ïù¥ÌÑ∞Î•º axiosÎ•º ÌÜµÌï¥ Ï†ÄÏû•üò¶
    upload() {
      PropertyDataService.upload(
        this.propertyTitle,
        this.currentProperty,
        this.propertyPrice,
        this.propertyAddress,
        this.propertyCity,
        this.propertyBed,
        this.propertyBath
      )
        // insert ÏÑ±Í≥µ then()
        .then((response) => {
          // ÏÑúÎ≤ÑÏ™Ω ÏÑ±Í≥µ Î©îÏÑ∏ÏßÄÎ•º Ï†ÄÏû•
          this.message = response.data.message;

          // Í≤ÄÏÉâ : Ïû¨Ï°∞Ìöå ÏöîÏ≤≠(axios Ï°∞ÌöåÌï®Ïàò .getPropertys()) : Îç∞Ïù¥ÌÑ∞ Ïûò Îì§Ïñ¥ÏôîÎäîÏßÄ ÌôîÎ©¥Ïóê Ï∂úÎ†• ÏöîÏ≤≠
          return PropertyDataService.getPropertys(
            (this.searchSelect = "Title"), // searchSelect Ïóê title ÏÑ†ÌÉùÌïú Í≤É. Ï°∞Í±¥ ÎåÄÏùë ü•∂
            this.propertyTitle, // proprtyTitle Ï°∞Í±¥ ÎåÄÏùë
            this.page - 1,
            this.pageSize
          );
        })
        // Ï°∞ÌöåÍ∞Ä ÏÑ±Í≥µÌïòÎ©¥ Ïã§ÌñâÎêòÎäî then()
        .then((response2) => {
          const { property, totalItems } = response2.data;
          this.property = property;
          this.count = totalItems;
          console.log(response2.data);
        })
        .catch((e) => {
          console.log(e);
          // ÏÑúÎ≤Ñ Ï™ΩÏóêÏÑú Ïã§Ìå® Î©îÏãúÏßÄÎ•º Î∞õÏïÑÏÑú ÌôîÎ©¥Ïóê Ï∂úÎ†•
          this.message = "Could not upload the image!!   " + e;
          this.currentProperty = undefined;
        });
    },
    // // select box Í∞í Î≥ÄÍ≤ΩÏãú Ïã§ÌñâÎêòÎäî Ìï®Ïàò(Ïû¨Ï°∞Ìöå)
    // handlePageSizeChange(event) {
    //   this.pageSize = event.target.value; // ÌïúÌéòÏù¥ÏßÄÎãπ Í∞úÏàò Ï†ÄÏû•(3, 6, 9)
    //   this.page = 1;
    //   // Ïû¨Ï°∞Ìöå Ìï®Ïàò Ìò∏Ï∂ú
    //   this.retrieveProperty();
    // },
    // // ÌéòÏù¥ÏßÄ Î≤àÌò∏ Î≥ÄÍ≤ΩÏãú Ïã§ÌñâÎêòÎäî Ìï®Ïàò(Ïû¨Ï°∞Ìöå)
    // handlePageChange(value) {
    //   this.page = value; // Îß§Í∞úÎ≥ÄÏàòÍ∞íÏúºÎ°ú ÌòÑÏû¨ÌéòÏù¥ÏßÄ Î≥ÄÍ≤Ω
    //   // Ïû¨Ï°∞Ìöå Ìï®Ïàò Ìò∏Ï∂ú
    //   this.retrieveProperty();
    // },
    // // pnoÎ°ú ÏÇ≠Ï†úÌïòÎäî Ìï®Ïàò
    // deleteImage(pno) {
    //   // axios Í≥µÌÜµÌï®Ïàò Ìò∏Ï∂ú
    //   PropertyDataService.delete(pno)
    //     // ÏÑ±Í≥µÌïòÎ©¥ then() Í≤∞Í≥ºÍ∞Ä Ï†ÑÏÜ°Îê®
    //     .then((response) => {
    //       console.log(response);
    //       // Ï≤´ÌéòÏù¥ÏßÄ(Ï†ÑÏ≤¥Î™©Î°ù_Ï°∞Ìöå_ÌéòÏù¥ÏßÄ) Í∞ïÏ†ú Ïù¥Îèô : /property
    //       this.message = "Ï†ïÏÉÅÏ†ÅÏúºÎ°ú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.";
    //       // ÏÇ≠Ï†ú ÌõÑ Ïû¨Ï°∞Ìöå
    //       this.retrieveProperty();
    //     })
    //     // Ïã§Ìå®ÌïòÎ©¥ .catch() ÏóêÎü¨Î©îÏÑ∏ÏßÄÍ∞Ä Ï†ÑÏÜ°Îê®
    //     .catch((e) => {
    //       console.log(e);
    //       this.message = "Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§." + e.message;
    //     });
    // },
  },
  // ÌôîÎ©¥Ïù¥ Îú®Ïûê ÎßàÏûê Ïã§ÌñâÎêòÎäî Ïù¥Î≤§Ìä∏ - Ï†ÑÏ≤¥Ï°∞Ìöå Ìï®Ïàò retrieveProperty() Ïã§Ìñâ
  mounted() {
    // this.retrieveProperty();
    navbarCom();
    counterCom();
    customCom();
  },
};
</script>

<style>
.preview {
  width: 200px;
  height: 150px;
}
</style>
